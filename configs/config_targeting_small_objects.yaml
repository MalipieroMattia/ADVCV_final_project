# This config is optimized for detecting tiny defects:
# Mouse Bite (MB): <15px, very small
# Conductor Scratch (CS): <3px wide, thin lines

seed: 42
project_name: "PCB_Defect_Detection"

model:
  # P2 architecture instead of standard yolov8m, P2 adds a detection head at stride 4 (vs stride 8 for P3), this preserves tiny features (<15px) that disappear in standard P5 layer
  name: "yolov8m-p2"
  pretrained: true
  freeze_layers: 0  # Actual freeze control;  overridden by --freeze in scripts/run_experiments.sh via main.py

# =============================================================================
# DATA CONFIGURATION
# =============================================================================
data:
  root: "/work/Data_YOLO_unsplit"
  
  split:
    val_ratio: 0.15
    test_ratio: 0.15
  
  train_images: "images/train"
  train_labels: "labels/train"
  val_images: "images/val"
  val_labels: "labels/val"
  
  num_classes: 9
  class_names:
    0: "SH"
    1: "SP"
    2: "SC"
    3: "OP"
    4: "MB"  
    5: "HB"
    6: "CS"   
    7: "CFO"
    8: "BMFO"

# =============================================================================
# TRAINING CONFIGURATION 
# =============================================================================
training:
  epochs: 100  
  imgsz: 640    # Keep identical preprocessing across models for fair comparison
  batch_size: 16
  patience: 50
  save_period: 10
  workers: 8
  device: null
  
  optimizer:
    name: "auto"
    lr0: 0.01
    lrf: 0.01
    momentum: 0.937
    weight_decay: 0.0005
    warmup_epochs: 3.0
    warmup_momentum: 0.8
    warmup_bias_lr: 0.1

# =============================================================================
# AUGMENTATION CONFIGURATION 
# =============================================================================
augmentation:
  enabled: true
  hsv_h: 0.015
  hsv_s: 0.7
  hsv_v: 0.4
  degrees: 0.0
  translate: 0.1
  scale: 0.5
  shear: 0.0
  perspective: 0.0
  flipud: 0.0
  fliplr: 0.5
  mosaic: 1.0
  mixup: 0.0
  copy_paste: 0.0

# =============================================================================
# OUTPUT CONFIGURATION
# =============================================================================
output:
  project: "PCB_Defect_Detection"
  name: "small_objects_p2"
  exist_ok: true
  save: true
  save_txt: true
  save_conf: true
  plots: true

# =============================================================================
# WEIGHTS & BIASES CONFIGURATION
# =============================================================================
wandb:
  enabled: true
  project: "PCB_Defect_Detection"
  entity: "jojs-it-universitetet-i-k-benhavn"
  run_name: null
  tags: ["yolov8-p2", "pcb", "small-objects"]
  mode: "online"
